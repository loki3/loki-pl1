// unittests for help.l3

:helpAll @unittest noTestNeeded

:help @unittest func()
	// simply validate that help doesn't crash on various functions
	help :rethrow
	help :l3.ifBody
	help :@@hasKeys

:describe @unittest func()
	// simple value
	:a v= 5
	:map v= describe :a
	:a         assert=? map . :general . :name
	:int       assert=? map . :general . :type
	
	// prefix
	:fPrefix v= func .( ->a : :int
		true
	:fPrefix @order 4 @cat :thing @doc :something
	:map v= describe :fPrefix
	:fPrefix   assert=? map . :general . :name
	:function  assert=? map . :general . :type
	:something assert=? map . :general . :documentation
	:thing     assert=? map . :general . :category
	:prefix    assert=? map . :specific . :fix
	4          assert=? map . :specific . :order
	1          assert=? map . :specific . :overloads .size
	[ ]        assert=? map . :specific . :overloads . 0 . :pre
	:a         assert=? map . :specific . :overloads . 0 . :post . 0 . :name
	:int       assert=? map . :specific . :overloads . 0 . :post . 0 . :type
	
	// infix
	:fInfix v= .( ->a infix ->b
		true
	:map v= describe :fInfix
	:fInfix    assert=? map . :general . :name
	:infix     assert=? map . :specific . :fix
	:a         assert=? map . :specific . :overloads . 0 . :pre . 0 . :name
	:b         assert=? map . :specific . :overloads . 0 . :post . 0 . :name
	
	// postfix
	:fPostfix v= .( ->a postfix
		true
	:map v= describe :fPostfix
	:postfix   assert=? map . :specific . :fix
	:a         assert=? map . :specific . :overloads . 0 . :pre . 0 . :name
	[ ]        assert=? map . :specific . :overloads . 0 . :post
	
	// no parameters
	:fNofix v= func()
		true
	// todo: this doesn't work
	// :map v= describe :fNofix
	
	// overload
	:fOverload f= func .( ->a : :int
		true
	:fOverload f= func .( ->a : :string
		true
	:map v= describe :fOverload
	:fOverload assert=? map . :general . :name
	2          assert=? map . :specific . :overloads .size


:dumpBody @unittest noTestNeeded

:dumpMeta @unittest noTestNeeded

:dumpStack @unittest noTestNeeded

:dumpCurrentStack @unittest noTestNeeded

:listFunctions @unittest noTestNeeded

:listEnums @unittest noTestNeeded

:listDelimiters @unittest noTestNeeded

:listByCat @unittest noTestNeeded

:getDocs @unittest noTestNeeded

:getDocsInScope @unittest noTestNeeded

:getFileDocs @unittest noTestNeeded

:prettify @unittest noTestNeeded
