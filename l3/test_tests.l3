// unittests for test.l3

:fizzbuzz20 v= .[ 1 2 :fizz 4 :buzz :fizz 7 8 :fizz :buzz 11 :fizz 13 14 :fizzbuzz 16 17 :fizz 19 :buzz
:fizzbuzz20 @doc ." Expected output for fizzbuzz from 1 to 20
:fizzbuzz20 @unittest true

:fizzBuzz1 @unittest func()
	fizzbuzz20 assert=? fizzBuzz1

:fizzBuzz2 @unittest func()
	fizzbuzz20 assert=? fizzBuzz2

:fizzbuzz3 @unittest func()
	fizzbuzz20 assert=? fizzbuzz3

:i @unittest func()
	{ :x 0 :y 3 } assert=? 3 i

:+ @unittest func()
	{ :x 4 :y 6 } assert=? { :x 1 :y 2 } + { :x 3 :y 4 }
	{ :x 3 :y 8 } assert=? 4 i + { :x 3 :y 4 }
	{ :x 1 :y 2 } assert=? 1 + 2 i
	{ :x 1 :y 2 } assert=? 2 i + 1

:* @unittest func()
	{ :x -12 :y 0 } assert=? 4 i * 3 i

// stub out tests & docstrings for the enum & its values
:days			@unittest ( stubFunc )
:days.sunday	@unittest ( stubFunc ) @doc ."
:days.monday	@unittest ( stubFunc ) @doc ."
:days.tuesday	@unittest ( stubFunc ) @doc ."
:days.wednesday	@unittest ( stubFunc ) @doc ."
:days.thursday	@unittest ( stubFunc ) @doc ."
:days.friday	@unittest ( stubFunc ) @doc ."
:days.saturday	@unittest ( stubFunc ) @doc ."

:isWeekend @unittest func()
	( isWeekend days.sunday )	assert=? true
	( isWeekend days.monday )	assert=? false
	( isWeekend days.tuesday )	assert=? false
	( isWeekend days.wednesday ) assert=? false
	( isWeekend days.thursday )	assert=? false
	( isWeekend days.friday )	assert=? false
	( isWeekend days.sunday )	assert=? true

:repeat @unittest func()
	:sum v= func ->n
		:add v= func [ ->a ->b ]
			( a >? 0 ) ? .[ [ ( a + b ) ( add [ ( a - 1 ) ] ) ]  [ b nil ]
		repeat [ 0 ( add [ n ] ) ]
	10 assert=? sum 4
	55 assert=? sum 10


:testFactorial v= func()
	1       assert=? 0 !
	1       assert=? 1 !
	24      assert=? 4 !
	3628800 assert=? 10 !
:testFactorial @unittest ( stubFunc ) @doc ." general testing for a factorial function

:! @unittest func()
	testFactorial

:!2 @unittest func()
	testFactorial


:testFib v= func()
	1	assert=? fib1 0
	1	assert=? fib1 1
	2	assert=? fib1 2
	3	assert=? fib1 3
	5	assert=? fib1 4
	8	assert=? fib1 5
:testFib @unittest ( stubFunc ) @doc ." general testing for a Fibonacci function

:fib1 @unittest func()
	testFib

:fib2 @unittest func()
	testFib


:unitsType			@unittest ( stubFunc )
:unitsType.distance	@unittest ( stubFunc ) @doc ."
:unitsType.weight	@unittest ( stubFunc ) @doc ."

:mm @unittest func()
	5.5 assert=? 5.5 mm =>mm

:m  @unittest func()
	4 assert=? 4 m =>m

:in @unittest func()
	1 assert=? 1 in =>in

:ft @unittest func()
	2 assert=? 2 ft =>ft


:=>mm @unittest func()
	2000 assert=? 2 m =>mm

:=>m  @unittest func()
	0.6096 assert=? 2 ft =>m

:=>in @unittest func()
	2 assert=? 50.8 mm =>in

:=>ft @unittest func()
	2.5 assert=? 2.5 ft =>ft


:g  @unittest func()
	1 assert=? 1000 g =>kg

:kg @unittest func()
	2000 assert=? 2 kg =>g

:oz @unittest func()
	1 assert=? 16 oz =>lb

:lb @unittest func()
	16 assert=? 1 lb =>oz


:=>g  @unittest func()
	1500 assert=? 1.5 kg =>g

:=>kg @unittest func()
	.123 assert=? 123 g =>kg

:=>oz @unittest func()
	64 assert=? 4 lb =>oz

:=>lb @unittest func()
	0.5 assert=? 8 oz =>lb


:- @unittest func()
	3.3322 assert=? 2 mm + 3 m + 1 ft + 1 in =>m
	1900 assert=? 2 m - 100 mm =>mm
	2222 assert=? 2 kg + 222 g =>g
	1778 assert=? 2 kg - 222 g =>g
